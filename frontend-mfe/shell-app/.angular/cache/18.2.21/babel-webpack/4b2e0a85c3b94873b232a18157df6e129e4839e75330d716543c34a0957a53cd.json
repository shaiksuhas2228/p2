{"ast":null,"code":"import { BehaviorSubject } from 'rxjs';\nimport { tap } from 'rxjs/operators';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nexport let AuthService = /*#__PURE__*/(() => {\n  class AuthService {\n    constructor(http) {\n      this.http = http;\n      this.apiUrl = 'http://localhost:8081/api/auth';\n      this.currentUserSubject = new BehaviorSubject(null);\n      this.currentUser$ = this.currentUserSubject.asObservable();\n      const token = localStorage.getItem('token');\n      if (token) {\n        try {\n          const userStr = localStorage.getItem('user');\n          const user = userStr ? JSON.parse(userStr) : null;\n          if (user) {\n            this.currentUserSubject.next(user);\n          }\n        } catch (e) {\n          console.error('Error parsing user data:', e);\n          localStorage.removeItem('user');\n          localStorage.removeItem('token');\n        }\n      }\n    }\n    login(credentials) {\n      return this.http.post(`${this.apiUrl}/login`, credentials).pipe(tap(response => {\n        localStorage.setItem('token', response.token);\n        localStorage.setItem('user', JSON.stringify({\n          id: response.id,\n          username: response.username,\n          email: response.email\n        }));\n        this.currentUserSubject.next({\n          id: response.id,\n          username: response.username,\n          email: response.email\n        });\n      }));\n    }\n    register(userData) {\n      return this.http.post(`${this.apiUrl}/register`, userData, {\n        responseType: 'text'\n      });\n    }\n    logout() {\n      return this.http.post(`${this.apiUrl}/logout`, {}).pipe(tap(() => {\n        localStorage.removeItem('token');\n        localStorage.removeItem('user');\n        this.currentUserSubject.next(null);\n      }));\n    }\n    getToken() {\n      return localStorage.getItem('token');\n    }\n    isLoggedIn() {\n      return !!this.getToken();\n    }\n    getCurrentUser() {\n      return this.currentUserSubject.value;\n    }\n    forgotPassword(email) {\n      return this.http.post(`${this.apiUrl}/forgot-password?email=${encodeURIComponent(email)}`, null, {\n        responseType: 'text'\n      });\n    }\n    resetPassword(email, otp, newPassword) {\n      return this.http.post(`${this.apiUrl}/reset-password?email=${encodeURIComponent(email)}&otp=${encodeURIComponent(otp)}&newPassword=${encodeURIComponent(newPassword)}`, null, {\n        responseType: 'text'\n      });\n    }\n    searchUsers(query) {\n      return this.http.get(`http://localhost:8080/search/users?q=${encodeURIComponent(query || '')}`);\n    }\n    verifyOTP(email, otp) {\n      return this.http.post(`${this.apiUrl}/verify-otp?email=${encodeURIComponent(email)}&otp=${encodeURIComponent(otp)}`, null, {\n        responseType: 'text'\n      });\n    }\n    resendVerificationEmail(email) {\n      return this.http.post(`${this.apiUrl}/resend-otp?email=${encodeURIComponent(email)}`, null, {\n        responseType: 'text'\n      });\n    }\n    static {\n      this.ɵfac = function AuthService_Factory(__ngFactoryType__) {\n        return new (__ngFactoryType__ || AuthService)(i0.ɵɵinject(i1.HttpClient));\n      };\n    }\n    static {\n      this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n        token: AuthService,\n        factory: AuthService.ɵfac,\n        providedIn: 'root'\n      });\n    }\n  }\n  return AuthService;\n})();","map":{"version":3,"names":["BehaviorSubject","tap","AuthService","constructor","http","apiUrl","currentUserSubject","currentUser$","asObservable","token","localStorage","getItem","userStr","user","JSON","parse","next","e","console","error","removeItem","login","credentials","post","pipe","response","setItem","stringify","id","username","email","register","userData","responseType","logout","getToken","isLoggedIn","getCurrentUser","value","forgotPassword","encodeURIComponent","resetPassword","otp","newPassword","searchUsers","query","get","verifyOTP","resendVerificationEmail","i0","ɵɵinject","i1","HttpClient","factory","ɵfac","providedIn"],"sources":["C:\\Users\\acer\\Downloads\\RevHubTeam7final_2\\RevHubTeam7final\\RevHub\\frontend-mfe\\shell-app\\src\\app\\core\\services\\auth.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Observable, BehaviorSubject } from 'rxjs';\r\nimport { tap } from 'rxjs/operators';\r\n\r\nexport interface LoginRequest {\r\n  username: string;\r\n  password: string;\r\n}\r\n\r\nexport interface RegisterRequest {\r\n  username: string;\r\n  email: string;\r\n  password: string;\r\n}\r\n\r\nexport interface JwtResponse {\r\n  token: string;\r\n  type: string;\r\n  id: number;\r\n  username: string;\r\n  email: string;\r\n}\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class AuthService {\r\n  private apiUrl = 'http://localhost:8081/api/auth';\r\n  private currentUserSubject = new BehaviorSubject<any>(null);\r\n  public currentUser$ = this.currentUserSubject.asObservable();\r\n\r\n  constructor(private http: HttpClient) {\r\n    const token = localStorage.getItem('token');\r\n    if (token) {\r\n      try {\r\n        const userStr = localStorage.getItem('user');\r\n        const user = userStr ? JSON.parse(userStr) : null;\r\n        if (user) {\r\n          this.currentUserSubject.next(user);\r\n        }\r\n      } catch (e) {\r\n        console.error('Error parsing user data:', e);\r\n        localStorage.removeItem('user');\r\n        localStorage.removeItem('token');\r\n      }\r\n    }\r\n  }\r\n\r\n  login(credentials: LoginRequest): Observable<JwtResponse> {\r\n    return this.http.post<JwtResponse>(`${this.apiUrl}/login`, credentials)\r\n      .pipe(\r\n        tap(response => {\r\n          localStorage.setItem('token', response.token);\r\n          localStorage.setItem('user', JSON.stringify({\r\n            id: response.id,\r\n            username: response.username,\r\n            email: response.email\r\n          }));\r\n          this.currentUserSubject.next({\r\n            id: response.id,\r\n            username: response.username,\r\n            email: response.email\r\n          });\r\n        })\r\n      );\r\n  }\r\n\r\n  register(userData: RegisterRequest): Observable<string> {\r\n    return this.http.post(`${this.apiUrl}/register`, userData, { responseType: 'text' });\r\n  }\r\n\r\n  logout(): Observable<any> {\r\n    return this.http.post(`${this.apiUrl}/logout`, {}).pipe(\r\n      tap(() => {\r\n        localStorage.removeItem('token');\r\n        localStorage.removeItem('user');\r\n        this.currentUserSubject.next(null);\r\n      })\r\n    );\r\n  }\r\n\r\n  getToken(): string | null {\r\n    return localStorage.getItem('token');\r\n  }\r\n\r\n  isLoggedIn(): boolean {\r\n    return !!this.getToken();\r\n  }\r\n\r\n  getCurrentUser(): any {\r\n    return this.currentUserSubject.value;\r\n  }\r\n\r\n  forgotPassword(email: string): Observable<string> {\r\n    return this.http.post(`${this.apiUrl}/forgot-password?email=${encodeURIComponent(email)}`, null, { responseType: 'text' });\r\n  }\r\n\r\n  resetPassword(email: string, otp: string, newPassword: string): Observable<string> {\r\n    return this.http.post(`${this.apiUrl}/reset-password?email=${encodeURIComponent(email)}&otp=${encodeURIComponent(otp)}&newPassword=${encodeURIComponent(newPassword)}`, null, { responseType: 'text' });\r\n  }\r\n\r\n  searchUsers(query: string): Observable<any[]> {\r\n    return this.http.get<any[]>(`http://localhost:8080/search/users?q=${encodeURIComponent(query || '')}`);\r\n  }\r\n  \r\n  verifyOTP(email: string, otp: string): Observable<string> {\r\n    return this.http.post(`${this.apiUrl}/verify-otp?email=${encodeURIComponent(email)}&otp=${encodeURIComponent(otp)}`, null, { responseType: 'text' });\r\n  }\r\n  \r\n  resendVerificationEmail(email: string): Observable<string> {\r\n    return this.http.post(`${this.apiUrl}/resend-otp?email=${encodeURIComponent(email)}`, null, { \r\n      responseType: 'text' \r\n    });\r\n  }\r\n  \r\n\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}